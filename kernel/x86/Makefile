include x86.rules
include ../../general.rules

C_SRCS=main.c
ASM_SRCS=init.asm
OBJS=init.o main.o ../mm/pmm.o ../mm/malloc.o ../utils.o ../printf.o ../screen.o ../assert.o ../rtc.o ../itoa.o ../video/bga.o ../video/tm.o ../pci.o

.PHONY: all

all: $(OBJS)
	$(LD) $(LDFLAGS) -Map $(BIN_x86_MAP) -o $(BIN_x86_KRNL) $(OBJS)

%.o: %.c
	$(CC) $(CFLAGS) $^ -o $@

%.o: %.asm
	$(NASM) $(ASFLAGS) $^ -o $@
	
clean:
	$(RM) -f $(OBJS)